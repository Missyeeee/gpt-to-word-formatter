<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT to Word Format Converter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
        }
        textarea, #output {
            width: 100%;
            min-height: 300px;
            margin-bottom: 10px;
            padding: 10px;
            box-sizing: border-box;
            background-color: white;
            border: 1px solid #ccc;
        }
        #output {
            white-space: pre-wrap;
            font-family: 'Times New Roman', Times, serif;
            font-size: 12pt;
            line-height: 1.5;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>GPT to Word Format Converter</h1>
    <p>Instructions: Paste your text, click "Format Text", then "Copy Formatted Text". In Word, paste using "Keep Text Only" option.</p>
    <textarea id="input" placeholder="Paste your GPT text here..."></textarea>
    <button onclick="formatText()">Format Text</button>
    <button onclick="copyText()">Copy Formatted Text</button>
    <div id="output"></div>

    <script>
        function formatText() {
            let text = document.getElementById('input').value;
            
            // 分割成段落
            let paragraphs = text.split(/\n(?=\d+\.)/);
            
            let formattedText = paragraphs.map(function(para) {
                // 处理编号主题
                if (para.trim().match(/^\d+\./)) {
                    let [title, ...items] = para.split('\n');
                    let formattedItems = items.map(item => {
                        item = item.trim();
                        if (item.startsWith('•')) {
                            // 使用特殊字符来模拟缩进和项目符号
                            return '    • ' + item.substring(1).trim();
                        }
                        return item;
                    });
                    // 使用特殊字符来模拟标题格式
                    return title + '\n' + formattedItems.join('\n');
                }
                // 处理其他段落
                else {
                    return para.trim();
                }
            }).join('\n\n');

            // 添加一些额外的换行符来确保段落分隔
            formattedText = formattedText.replace(/\n\n/g, '\n\n\n');

            document.getElementById('output').textContent = formattedText;
        }

        function copyText() {
            const output = document.getElementById('output');
            navigator.clipboard.writeText(output.textContent).then(function() {
                alert('Formatted text copied to clipboard!');
            }, function(err) {
                console.error('Could not copy text: ', err);
            });
        }
    </script>
</body>
</html>
