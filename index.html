<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT to Word Format Converter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
        }
        textarea, #output {
            width: 100%;
            min-height: 300px;
            margin-bottom: 10px;
            padding: 10px;
            box-sizing: border-box;
            background-color: white;
            border: 1px solid #ccc;
        }
        #output {
            white-space: pre-wrap;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            margin-right: 10px;
        }
        h1, h2, h3, h4, h5, h6 {
            margin-top: 20px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>GPT to Word Format Converter</h1>
    <textarea id="input" placeholder="Paste your GPT text here..."></textarea>
    <button onclick="formatText()">Format Text</button>
    <button onclick="copyText()">Copy Formatted Text</button>
    <div id="output"></div>

    <script>
        function formatText() {
            let text = document.getElementById('input').value;
            
            // 分割成段落
            let paragraphs = text.split(/\n(?=\d+\.)/);
            
            let formattedText = paragraphs.map(function(para) {
                // 处理编号主题
                if (para.trim().match(/^\d+\./)) {
                    let [title, ...items] = para.split('\n');
                    let formattedTitle = '<h3>' + title.trim() + '</h3>';
                    let formattedItems = items.map(item => {
                        item = item.trim();
                        if (item.startsWith('•')) {
                            return '<li>' + item.substring(1).trim() + '</li>';
                        }
                        return item;
                    });
                    return formattedTitle + '<ul>' + formattedItems.join('') + '</ul>';
                }
                // 处理其他段落
                else {
                    return '<p>' + para.trim() + '</p>';
                }
            }).join('');

            // 添加整体样式，使用 Times New Roman 字体
            formattedText = '<div style="font-family: \'Times New Roman\', Times, serif; font-size: 12pt; line-height: 1.5;">' + 
                            formattedText + 
                            '</div>';

            document.getElementById('output').innerHTML = formattedText;
        }

        function copyText() {
            const output = document.getElementById('output');
            const range = document.createRange();
            range.selectNode(output);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();
            alert('Formatted text copied to clipboard!');
        }
    </script>
</body>
</html>
